DROP TABLE IF EXISTS groupaccess ;
DROP TABLE IF EXISTS ingroup;
DROP TABLE IF EXISTS users;
DROP TABLE IF EXISTS groups;
DROP TABLE IF EXISTS books;
DROP TABLE IF EXISTS access;

CREATE OR REPLACE TABLE users
(ID INT NOT NULL AUTO_INCREMENT,
username VARCHAR(300) NOT NULL,
password VARCHAR(300) NOT NULL,
PRIMARY KEY(ID));

CREATE OR REPLACE TABLE groups
(ID INT NOT NULL AUTO_INCREMENT,
groupname VARCHAR(300) NOT NULL,
PRIMARY KEY(ID));

CREATE OR REPLACE TABLE books
(ID INT NOT NULL AUTO_INCREMENT,
name VARCHAR(300) NOT NULL,
ISBN VARCHAR(300) NOT NULL,
path VARCHAR(300) NOT NULL,
PRIMARY KEY(ID));

CREATE OR REPLACE TABLE access
(ID INT NOT NULL AUTO_INCREMENT,
accesstype VARCHAR(300) NOT NULL,
PRIMARY KEY(ID));

CREATE OR REPLACE TABLE ingroup
(IDU INT NOT NULL UNIQUE KEY,
 IDG INT NOT NULL UNIQUE KEY,
 CONSTRAINT fk_idu_ingroup FOREIGN KEY (IDU) REFERENCES users (id),
 CONSTRAINT fk_idg_ingroup FOREIGN KEY (IDG) REFERENCES groups (id)
);

CREATE OR REPLACE TABLE groupaccess
(IDG INT NOT NULL UNIQUE KEY,
 IDA INT NOT NULL UNIQUE KEY,
 CONSTRAINT fk_idg_groupaccess FOREIGN KEY (IDG) REFERENCES groups (id),
 CONSTRAINT fk_ida_groupaccess FOREIGN KEY (IDA) REFERENCES access (id)
);

INSERT INTO users(username,password) VALUES("Admin","admin");
INSERT INTO groups(groupname) VALUES ("ADMINISTRATOR");
INSERT INTO access(accesstype) VALUES ("Admin");
INSERT INTO access(accesstype) VALUES ("User");

INSERT INTO ingroup(IDU,IDG) VALUES (
(SELECT ID FROM users where username="ADMIN"),
(SELECT ID FROM groups where groupname="ADMINISTRATOR")
);

INSERT INTO groupaccess(IDG,IDA) VALUES (
(SELECT ID FROM groups where groupname="ADMINISTRATOR"),
(SELECT ID FROM access where accesstype="Admin")
);
